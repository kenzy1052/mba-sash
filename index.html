<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MBA Graduation Sash Orders - 2025</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
          --primary-color: #1a3a5f;
          --secondary-color: #2c5282;
          --accent-color: #3182ce;
          --light-color: #ebf8ff;
          --dark-color: #1a202c;
          --text-color: #2d3748;
          --success-color: #38a169;
          --warning-color: #d69e2e;
          --gold-color: #d4af37;
          --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          --hover-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
      }

      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Montserrat', sans-serif;
          background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
          color: var(--text-color);
          line-height: 1.6;
          min-height: 100vh;
      }

      .container {
          max-width: 1400px;
          margin: 0 auto;
          padding: 20px;
      }

      header {
          text-align: center;
          margin-bottom: 40px;
          padding: 40px 20px;
          background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
          border-radius: 10px;
          box-shadow: var(--card-shadow);
          color: white;
          position: relative;
          overflow: hidden;
      }

      header::before {
          content: "";
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: url('https://picsum.photos/seed/mba-graduation/1200/300.jpg');
          background-size: cover;
          opacity: 0.2;
          z-index: 0;
      }

      .header-content {
          position: relative;
          z-index: 1;
      }

      header h1 {
          font-family: 'Playfair Display', serif;
          font-size: 2.8rem;
          margin-bottom: 10px;
          font-weight: 700;
          letter-spacing: 1px;
      }

      header p {
          font-size: 1.2rem;
          opacity: 0.9;
          max-width: 800px;
          margin: 0 auto;
      }

      .logo-badge {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 80px;
          height: 80px;
          background: var(--gold-color);
          border-radius: 50%;
          margin-bottom: 20px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .logo-badge i {
          font-size: 2.5rem;
          color: white;
      }

      .stats-container {
          display: flex;
          justify-content: space-around;
          margin: 40px 0;
          flex-wrap: wrap;
          gap: 20px;
      }

      .stat-card {
          background: white;
          border-radius: 10px;
          padding: 25px;
          flex: 1;
          min-width: 200px;
          text-align: center;
          box-shadow: var(--card-shadow);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
          border-top: 4px solid var(--accent-color);
      }

      .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: var(--hover-shadow);
      }

      .stat-card i {
          font-size: 2.5rem;
          color: var(--accent-color);
          margin-bottom: 15px;
      }

      .stat-card h3 {
          font-size: 2.2rem;
          margin-bottom: 5px;
          color: var(--primary-color);
          font-weight: 700;
      }

      .stat-card p {
          color: #666;
          font-weight: 500;
          text-transform: uppercase;
          font-size: 0.9rem;
          letter-spacing: 1px;
      }

      .search-filter-container {
          display: flex;
          justify-content: space-between;
          margin-bottom: 30px;
          flex-wrap: wrap;
          gap: 20px;
      }

      .search-box {
          flex: 1;
          min-width: 250px;
          position: relative;
      }

      .search-box input {
          width: 100%;
          padding: 15px 20px 15px 50px;
          border: none;
          border-radius: 50px;
          background: white;
          box-shadow: var(--card-shadow);
          font-size: 1rem;
          outline: none;
          transition: box-shadow 0.3s ease;
      }

      .search-box input:focus {
          box-shadow: var(--hover-shadow);
      }

      .search-box i {
          position: absolute;
          left: 20px;
          top: 50%;
          transform: translateY(-50%);
          color: var(--accent-color);
          font-size: 1.2rem;
      }

      .filter-buttons {
          display: flex;
          gap: 10px;
      }

      .filter-btn {
          padding: 15px 20px;
          border: none;
          border-radius: 50px;
          background: white;
          box-shadow: var(--card-shadow);
          font-size: 1rem;
          cursor: pointer;
          transition: all 0.3s ease;
          font-weight: 500;
          color: var(--text-color);
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .filter-btn:hover {
          background: var(--light-color);
          transform: translateY(-2px);
      }

      .filter-btn.active {
          background: var(--accent-color);
          color: white;
      }

      .cards-container {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
          gap: 30px;
          margin-top: 30px;
      }

      .card {
          background: white;
          border-radius: 12px;
          overflow: hidden;
          box-shadow: var(--card-shadow);
          transition: all 0.3s ease;
          position: relative;
          page-break-inside: avoid;
          break-inside: avoid;
      }

      .card:hover {
          box-shadow: var(--hover-shadow);
          transform: translateY(-5px);
      }

      .card-header {
          background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
          color: white;
          padding: 25px;
          position: relative;
      }

      .card-header::after {
          content: "";
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: var(--gold-color);
      }

      .card-header h2 {
          font-size: 1.5rem;
          margin-bottom: 10px;
          font-weight: 600;
          display: flex;
          align-items: center;
          gap: 10px;
      }

      .card-header .program {
          font-size: 1rem;
          opacity: 0.9;
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .card-header .institution {
          font-size: 0.9rem;
          opacity: 0.8;
          margin-top: 5px;
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .show-more-btn {
          background: rgba(255, 255, 255, 0.2);
          border: 1px solid rgba(255, 255, 255, 0.3);
          color: white;
          padding: 10px 20px;
          border-radius: 50px;
          cursor: pointer;
          font-size: 0.9rem;
          font-weight: 500;
          transition: all 0.3s ease;
          margin-top: 15px;
          display: inline-flex;
          align-items: center;
          gap: 8px;
      }

      .show-more-btn:hover {
          background: rgba(255, 255, 255, 0.3);
      }

      .show-more-btn i {
          transition: transform 0.3s ease;
      }

      .show-more-btn.active i {
          transform: rotate(180deg);
      }

      .card-body {
          padding: 0;
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.5s ease, padding 0.5s ease;
      }

      .card-body.active {
          padding: 25px;
          max-height: 1000px;
      }

      .info-row {
          display: flex;
          margin-bottom: 20px;
          border-bottom: 1px solid #f0f0f0;
          padding-bottom: 15px;
      }

      .info-row:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
      }

      .info-label {
          font-weight: 600;
          width: 40%;
          color: var(--primary-color);
          display: flex;
          align-items: center;
          gap: 10px;
      }

      .info-label i {
          color: var(--accent-color);
          width: 20px;
          text-align: center;
      }

      .info-value {
          width: 60%;
          color: #555;
      }

      .yes-no {
          display: inline-block;
          padding: 5px 12px;
          border-radius: 20px;
          font-size: 0.85rem;
          font-weight: 500;
      }

      .yes {
          background-color: rgba(56, 161, 105, 0.2);
          color: var(--success-color);
      }

      .no {
          background-color: rgba(245, 101, 101, 0.2);
          color: #e53e3e;
      }

      .inscription {
          background-color: var(--light-color);
          padding: 15px;
          border-radius: 8px;
          font-style: italic;
          text-align: center;
          margin-top: 15px;
          position: relative;
          border-left: 4px solid var(--gold-color);
      }

      .inscription::before {
          content: """;
          position: absolute;
          top: 0;
          left: 10px;
          font-size: 3rem;
          color: var(--gold-color);
          opacity: 0.3;
          line-height: 1;
      }

      .note {
          background-color: rgba(214, 158, 46, 0.1);
          border-left: 4px solid var(--warning-color);
          padding: 15px;
          margin-top: 15px;
          font-size: 0.9rem;
          border-radius: 0 5px 5px 0;
      }

      footer {
          text-align: center;
          margin-top: 50px;
          padding: 30px 20px;
          color: #666;
          font-size: 0.9rem;
          background: white;
          border-radius: 10px;
          box-shadow: var(--card-shadow);
      }

      .footer-content {
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap;
          gap: 20px;
      }

      .footer-logo {
          display: flex;
          align-items: center;
          gap: 10px;
          font-weight: 600;
          color: var(--primary-color);
      }

      .footer-logo i {
          font-size: 1.5rem;
          color: var(--gold-color);
      }

      .social-links {
          display: flex;
          gap: 15px;
      }

      .social-links a {
          color: var(--secondary-color);
          font-size: 1.2rem;
          transition: color 0.3s ease;
      }

      .social-links a:hover {
          color: var(--accent-color);
      }

      .no-results {
          text-align: center;
          padding: 50px 20px;
          color: var(--text-color);
      }

      .no-results i {
          font-size: 4rem;
          color: var(--accent-color);
          margin-bottom: 20px;
      }

      .no-results h3 {
          font-size: 1.5rem;
          margin-bottom: 10px;
      }

      .loading {
          display: none;
          text-align: center;
          padding: 50px;
      }

      .loading i {
          font-size: 3rem;
          color: var(--accent-color);
          animation: spin 2s infinite linear;
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      /* Print Styles */
      @media print {
          body {
              background: white;
              color: black;
              font-size: 12pt;
              line-height: 1.4;
          }

          .container {
              max-width: 100%;
              padding: 0;
          }

          header {
              background: none !important;
              color: black !important;
              box-shadow: none;
              border: 2px solid var(--primary-color);
              margin-bottom: 20pt;
              page-break-after: avoid;
          }

          header::before {
              display: none;
          }

          header h1 {
              font-size: 24pt;
              color: var(--primary-color) !important;
              margin-bottom: 5pt;
          }

          header p {
              font-size: 14pt;
              color: black !important;
              opacity: 1 !important;
          }

          .logo-badge {
              display: none;
          }

          /* Hide interactive elements */
          .stats-container,
          .search-filter-container,
          .show-more-btn,
          .social-links,
          footer {
              display: none !important;
          }

          /* Adjust cards for print */
          .cards-container {
              display: block;
              margin-top: 20pt;
              page-break-inside: avoid;
          }

          .card {
              background: white;
              border: 1px solid #ddd;
              box-shadow: none;
              margin-bottom: 20pt;
              page-break-inside: avoid;
              break-inside: avoid;
              orphans: 3;
              widows: 3;
          }

          .card-header {
              background: var(--primary-color) !important;
              color: white !important;
              padding: 15pt;
              page-break-inside: avoid;
          }

          .card-header h2 {
              font-size: 16pt;
              margin-bottom: 5pt;
          }

          .card-header .program {
              font-size: 12pt;
              margin-bottom: 3pt;
          }

          .card-header .institution {
              font-size: 11pt;
          }

          /* Show all card bodies when printing */
          .card-body {
              padding: 15pt !important;
              max-height: none !important;
              page-break-inside: avoid;
          }

          .info-row {
              margin-bottom: 10pt;
              padding-bottom: 8pt;
          }

          .info-label {
              font-weight: 600;
              width: 35%;
              font-size: 11pt;
          }

          .info-value {
              width: 65%;
              font-size: 11pt;
          }

          .yes-no {
              padding: 2pt 6pt;
              font-size: 10pt;
              border: 1px solid;
          }

          .yes {
              background-color: white !important;
              color: var(--success-color) !important;
              border-color: var(--success-color);
          }

          .no {
              background-color: white !important;
              color: #e53e3e !important;
              border-color: #e53e3e;
          }

          .inscription {
              background-color: #f8f8f8;
              padding: 10pt;
              border: 1px solid var(--gold-color);
              margin-top: 10pt;
              font-size: 11pt;
          }

          .note {
              background-color: #fff8e1;
              border: 1px solid var(--warning-color);
              padding: 8pt;
              margin-top: 10pt;
              font-size: 10pt;
          }

          /* Ensure no page breaks in critical places */
          h1, h2, h3 {
              page-break-after: avoid;
              page-break-inside: avoid;
          }

          .card-header {
              page-break-after: avoid;
              page-break-inside: avoid;
          }

          .info-row {
              page-break-inside: avoid;
          }

          /* Add print header */
          @page {
              margin: 1.5cm;
              size: A4;
              @top-center {
                  content: "MBA Graduation Sash Orders - 2025";
                  font-size: 10pt;
                  color: #666;
              }
              @bottom-center {
                  content: "Page " counter(page);
                  font-size: 10pt;
                  color: #666;
              }
          }

          /* Counter for numbering */
          .card {
              counter-increment: card-counter;
          }

          .card-header::before {
              content: counter(card-counter) ". ";
              font-weight: bold;
              margin-right: 5pt;
          }
      }

      @media (max-width: 768px) {
          .cards-container {
              grid-template-columns: 1fr;
          }

          header h1 {
              font-size: 2.2rem;
          }

          .info-row {
              flex-direction: column;
          }

          .info-label, .info-value {
              width: 100%;
          }

          .search-filter-container {
              flex-direction: column;
          }

          .filter-buttons {
              width: 100%;
              justify-content: space-between;
          }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-content">
          <div class="logo-badge">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <h1>MBA Graduation Sash Orders</h1>
          <p>University of Cape Coast - Class of 2025</p>
        </div>
      </header>

      <div class="stats-container">
        <div class="stat-card">
          <i class="fas fa-users"></i>
          <h3 id="totalOrders">15</h3>
          <p>Total Orders</p>
        </div>
        <div class="stat-card">
          <i class="fas fa-check-circle"></i>
          <h3 id="yearCompletion">11</h3>
          <p>With Year of Completion</p>
        </div>
        <div class="stat-card">
          <i class="fas fa-university"></i>
          <h3 id="uniquePrograms">6</h3>
          <p>Unique Programs</p>
        </div>
      </div>

      <div class="search-filter-container">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input
            type="text"
            id="searchInput"
            placeholder="Search by name, program, or institution..."
          />
        </div>
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all">
            <i class="fas fa-list"></i> All
          </button>
          <button class="filter-btn" data-filter="yes">
            <i class="fas fa-check"></i> With Year
          </button>
          <button class="filter-btn" data-filter="no">
            <i class="fas fa-times"></i> Without Year
          </button>
        </div>
      </div>

      <div class="loading" id="loading">
        <i class="fas fa-spinner"></i>
        <p>Loading orders...</p>
      </div>

      <div class="no-results" id="noResults" style="display: none">
        <i class="fas fa-search"></i>
        <h3>No results found</h3>
        <p>Try adjusting your search or filter criteria</p>
      </div>

      <div class="cards-container" id="cardsContainer">
        <!-- Cards will be dynamically generated here -->
      </div>

      <footer>
        <div class="footer-content">
          <div class="footer-logo">
            <i class="fas fa-graduation-cap"></i>
            <span>MBA Graduation Services</span>
          </div>
          <div>
            <p>
              &copy; 2025 University of Cape Coast MBA Program. All rights
              reserved.
            </p>
          </div>
          <div class="social-links">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
          </div>
        </div>
      </footer>
    </div>

    <script>
      // Data from the CSV
      const sashOrders = [
        {
          name: "AMOAFO CALEB AMPADU",
          yearOfCompletion: "Yes",
          program: "B.ED SOCIAL SCIENCE",
          institution: "UCC",
          otherInfo: "JOURNEYED WITH CHRIST",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "JOURNEYED WITH CHRIST",
        },
        {
          name: "ATTA NYARKOH GEORGE",
          yearOfCompletion: "No",
          program: "SOCIAL SCIENCES",
          institution: "UNIVERSITY OF CAPE COAST (UCC)",
          otherInfo: "",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "BELIEVE & ACHIEVE",
        },
        {
          name: "EVANS KOJO BAFFOE AKATSA ( NB: Evans KoJo baffoe Akatsa should be at the right side)",
          yearOfCompletion: "Yes",
          program: "BSC AGRIBUSINESS",
          institution: "University of cape Coast",
          otherInfo:
            "GLORIOUS END ( NB: the glorious end should be at the left side)",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "EVANS KOJO BAFFOE AKATSA ( NB : it should be at the right side)",
          yearOfCompletion: "Yes",
          program: "BSC AGRIBUSINESS",
          institution: "University of cape Coast",
          otherInfo: "GLORIOUS END( at the left side)",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "GEORGE ASANTE",
          yearOfCompletion: "Yes",
          program: "B.ED SOCIAL SCIENCES",
          institution: "UCC",
          otherInfo: "NYAME NE HENE",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "NYAME NE HENE",
        },
        {
          name: "MISS PERPETUAL ADU-BRAKO",
          yearOfCompletion: "No",
          program: "HUMAN RESOURCE MANAGEMENT",
          institution: "University of Cape Coast",
          otherInfo: "Quotation: Jeremiah 29:11\nA New Chapter In life",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "MISS PRISCILLA MENSAH",
          yearOfCompletion: "Yes",
          program: "BSC AGRIBUSINESS",
          institution: "University of Cape Coast",
          otherInfo: "GOD'S BEST",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "MISS PRISCILLA MENSAH",
          yearOfCompletion: "Yes",
          program: "BSC AGRIBUSINESS",
          institution: "University of cape coast",
          otherInfo: "GOD'S BEST",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "Mr. ABUBAKAR MUSTAPHA",
          yearOfCompletion: "Yes",
          program: "BSc Agribusiness",
          institution: "University of Cape Coast",
          otherInfo: "Alhamdulillah Regardless",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "Alhamdulillah Regardless",
        },
        {
          name: "Mr. Benjamin Mawutor Attakumah",
          yearOfCompletion: "No",
          program: "BSc health information management",
          institution: "University of Cape Coast",
          otherInfo: "Godsown",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "Godsown",
        },
        {
          name: "MISS WENDY YAYRA DZOTEPE",
          yearOfCompletion: "Yes",
          program: "BSC AGRIBUSINESS",
          institution: "UNIVERSITY OF CAPE COAST",
          otherInfo: "A Quotation - Jeremiah 29:11",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "PRISCILLA N.A MENSAH",
          yearOfCompletion: "Yes",
          program: "BSC AGRIBUSINESS",
          institution: "UNIVERSITY OF CAPE COAST",
          otherInfo: "GOD'S BEST",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "GOD'S BEST",
        },
        {
          name: "RICHARD OSEI POKU",
          yearOfCompletion: "Yes",
          program: "BA Economics and Geography",
          institution: "University of Cape Coast",
          otherInfo: "God Did",
          logoOption:
            "School logo on one side (with custom inscription/text on the other)",
          inscription: "By His grace",
        },
        {
          name: "SAMUEL OWUSU",
          yearOfCompletion: "Yes",
          program: "BSc. AGRIBUSINESS",
          institution: "UNIVERSITY OF CAPE COAST",
          otherInfo: "I MADE MAMA PROUD",
          logoOption: "School logo on both side",
          inscription: "",
        },
        {
          name: "TETTEH SIMON",
          yearOfCompletion: "Yes",
          program: "BA. SOCIAL SCIENCE",
          institution: "UCC",
          otherInfo: "",
          logoOption: "School logo on both side",
          inscription: "",
        },
      ];

      // Sort the data alphabetically by name
      sashOrders.sort((a, b) => a.name.localeCompare(b.name));

      // Current filter state
      let currentFilter = "all";
      let currentSearchTerm = "";

      // Create cards for each order
      function createCards(ordersToDisplay = sashOrders) {
        const container = document.getElementById("cardsContainer");
        container.innerHTML = "";

        if (ordersToDisplay.length === 0) {
          document.getElementById("noResults").style.display = "block";
          return;
        } else {
          document.getElementById("noResults").style.display = "none";
        }

        ordersToDisplay.forEach((order, index) => {
          const card = document.createElement("div");
          card.className = "card";

          // Extract the main name (before any parentheses)
          const mainName = order.name.split("(")[0].trim();

          // Check for special notes in the name
          const hasNameNote = order.name.includes("(");

          card.innerHTML = `
                    <div class="card-header">
                        <h2><i class="fas fa-user-graduate"></i> ${mainName}</h2>
                        <div class="program"><i class="fas fa-book-open"></i> ${
                          order.program
                        }</div>
                        <div class="institution"><i class="fas fa-university"></i> ${
                          order.institution
                        }</div>
                        <button class="show-more-btn" data-index="${index}">
                            View Details <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="card-body" id="card-body-${index}">
                        ${
                          hasNameNote
                            ? `<div class="note"><strong>Special Note:</strong> ${order.name.substring(
                                order.name.indexOf("(") + 1,
                                order.name.indexOf(")")
                              )}</div>`
                            : ""
                        }
                        <div class="info-row">
                            <div class="info-label"><i class="fas fa-user"></i> Full Name</div>
                            <div class="info-value">${order.name}</div>
                        </div>
                        <div class="info-row">
                            <div class="info-label"><i class="fas fa-calendar-alt"></i> Year of Completion</div>
                            <div class="info-value"><span class="yes-no ${order.yearOfCompletion.toLowerCase()}">${
            order.yearOfCompletion
          }</span></div>
                        </div>
                        <div class="info-row">
                            <div class="info-label"><i class="fas fa-graduation-cap"></i> Program</div>
                            <div class="info-value">${order.program}</div>
                        </div>
                        <div class="info-row">
                            <div class="info-label"><i class="fas fa-school"></i> Institution</div>
                            <div class="info-value">${order.institution}</div>
                        </div>
                        <div class="info-row">
                            <div class="info-label"><i class="fas fa-info-circle"></i> Additional Information</div>
                            <div class="info-value">${
                              order.otherInfo || "None"
                            }</div>
                        </div>
                        <div class="info-row">
                            <div class="info-label"><i class="fas fa-image"></i> Logo Option</div>
                            <div class="info-value">${order.logoOption}</div>
                        </div>
                        ${
                          order.inscription
                            ? `
                        <div class="inscription">
                            ${order.inscription}
                        </div>
                        `
                            : ""
                        }
                    </div>
                `;

          container.appendChild(card);
        });

        // Add event listeners to show more buttons
        document.querySelectorAll(".show-more-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            const index = this.getAttribute("data-index");
            const cardBody = document.getElementById(`card-body-${index}`);

            cardBody.classList.toggle("active");
            this.classList.toggle("active");

            if (cardBody.classList.contains("active")) {
              this.innerHTML = 'Hide Details <i class="fas fa-chevron-up"></i>';
            } else {
              this.innerHTML =
                'View Details <i class="fas fa-chevron-down"></i>';
            }
          });
        });
      }

      // Filter functionality
      function filterOrders() {
        let filteredOrders = [...sashOrders];

        // Apply search filter
        if (currentSearchTerm) {
          filteredOrders = filteredOrders.filter(
            (order) =>
              order.name
                .toLowerCase()
                .includes(currentSearchTerm.toLowerCase()) ||
              order.program
                .toLowerCase()
                .includes(currentSearchTerm.toLowerCase()) ||
              order.institution
                .toLowerCase()
                .includes(currentSearchTerm.toLowerCase())
          );
        }

        // Apply year completion filter
        if (currentFilter === "yes") {
          filteredOrders = filteredOrders.filter(
            (order) => order.yearOfCompletion === "Yes"
          );
        } else if (currentFilter === "no") {
          filteredOrders = filteredOrders.filter(
            (order) => order.yearOfCompletion === "No"
          );
        }

        createCards(filteredOrders);
      }

      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        createCards();

        // Update statistics
        const yearCompletionCount = sashOrders.filter(
          (order) => order.yearOfCompletion === "Yes"
        ).length;
        document.getElementById("yearCompletion").textContent =
          yearCompletionCount;

        const uniquePrograms = [
          ...new Set(sashOrders.map((order) => order.program)),
        ].length;
        document.getElementById("uniquePrograms").textContent = uniquePrograms;

        // Search functionality
        document
          .getElementById("searchInput")
          .addEventListener("input", function (e) {
            currentSearchTerm = e.target.value;
            filterOrders();
          });

        // Filter buttons functionality
        document.querySelectorAll(".filter-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            // Update active state
            document
              .querySelectorAll(".filter-btn")
              .forEach((b) => b.classList.remove("active"));
            this.classList.add("active");

            // Update filter and apply
            currentFilter = this.getAttribute("data-filter");
            filterOrders();
          });
        });

        // Handle print event
        window.addEventListener("beforeprint", function () {
          // Expand all cards before printing
          document.querySelectorAll(".card-body").forEach((body) => {
            body.classList.add("active");
          });
          document.querySelectorAll(".show-more-btn").forEach((btn) => {
            btn.style.display = "none";
          });
        });

        // Restore after print
        window.addEventListener("afterprint", function () {
          // Restore card states
          document.querySelectorAll(".card-body").forEach((body) => {
            body.classList.remove("active");
          });
          document.querySelectorAll(".show-more-btn").forEach((btn) => {
            btn.style.display = "inline-flex";
            btn.innerHTML = 'View Details <i class="fas fa-chevron-down"></i>';
          });
        });
      });
    </script>
  </body>
</html>
